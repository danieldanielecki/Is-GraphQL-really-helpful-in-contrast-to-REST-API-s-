<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>reveal.js</title>

	<link rel="stylesheet" href="dist/reset.css">
	<link rel="stylesheet" href="dist/reveal.css">
	<link rel="stylesheet" href="dist/theme/black.css">

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="plugin/highlight/monokai.css">
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<h2>Is GraphQL really helpful in contrast to REST API's?</h2>
				<p>Daniel Danielecki</p>
			</section>
			<section>
				<h2>What is a GraphQL?</h2>
				<p>Query language for API's, <strong>alternative</strong> (not replacement) for REST.</p>
			</section>
			<section>
				<h1>GraphQL vs REST</h1>
			</section>
			<section>
				<h2>GraphQL vs REST</h2>
				<table>
					<tr>
						<th>Feature</th>
						<th>REST</th>
						<th>GraphQL</th>
						<th>Similar/Different</th>
					</tr>
					<tr>
						<td>HTTP</td>
						<td>Yes</td>
						<td>Yes</td>
						<td>Similar</td>
					</tr>
					<tr>
						<td>API endp.</td>
						<td>Yes</td>
						<td>Yes</td>
						<td>Similar</td>
					</tr>
					<tr>
						<td>JSON</td>
						<td>Yes</td>
						<td>Yes</td>
						<td>Similar</td>
					</tr>
					<tr>
						<td>Request</td>
						<td>Rigid</td>
						<td>Flexible</td>
						<td>Different</td>
					</tr>
					<tr>
						<td>Call API</td>
						<td>Endpoint</td>
						<td>Query</td>
						<td>Different</td>
					</tr>
					<tr>
						<td>Response</td>
						<td>Server</td>
						<td>Client</td>
						<td>Different</td>
					</tr>
					<tr>
						<td>Size resp.</td>
						<td>Server</td>
						<td>Client</td>
						<td>Different</td>
					</tr>
				</table>
			</section>
			<section>
				<h1>Why GraphQL?</h1>
			</section>
			<section>
				<h1>Frontend?</h1>
			</section>
			<section>
				<h2>Why GraphQL?</h2>
				<p>Query only what you need.</p>
			</section>
			<section>
				<h1>Backend?</h1>
			</section>
			<section>
				<h2>Why GraphQL?</h2>
				<ul>
					<li>No Over/Under-Fetching</li>
					<li>Non-null</li>
					<li>Performance*</li>
					<li>Single Endpoint</li>
					<li>Strong Typing</li>
					<li>Subscriptions</li>
					<li>Versioning</li>
					<li>...</li>
				</ul>
			</section>
			<section>
				<h1>GraphQL?</h1>
			</section>
			<section>
				<span>(optional)</span>
				<h1>GraphQL Basics</h1>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Basics: Schema</h2>
			</section>
			<section>
				<span>(optional)</span>
				<pre><code>
type Query { ... }
type Mutation {	... }
type Subscription { ... }
input CreateUserInput { ... }
				</code></pre>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Basics: Object Types</h2>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Basics: Object Types</h2>
				<pre><code>
type User {
	id: ID!
	name: String!
	email: String!
	age: Int
	posts: [Post!]!
}
type Post {
	id: ID!
	title: String!
	body: String!
	author: User!
}
				</code></pre>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Basics: Query</h2>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Basics: Query</h2>
				<pre><code>
type Query {
	users(query: String): [User!]!
	posts(query: String): [Post!]!
	dummy: User!
	post: Post!
}
				</code></pre>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Basics: Query</h2>
				<pre><code>
query {
	dummy {
		id
	}
}
				</code></pre>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Query == "GET"</h2>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Mutations</h2>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Mutations</h2>
				<pre><code>
type Mutation {
	createUser(data: CreateUserInput!): User!
	deleteUser(id: ID!): User!
	updateUser(id: ID!, data: UpdateUserInput!): User!
}

input CreateUserInput {
  name: String!
  email: String!
  age: Int
}
				</code></pre>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Mutations</h2>
				<pre><code>
mutation {
	createUser(data: { name: "Daniel", email: "foo@example.com", age: 25 }) {
		id
		email
		age
	}
}
				</code></pre>
			</section>
			<section>
				<span>(optional)</span>
				<h3>GraphQL Mutation<br>==<br>"POST", "PUT", "PATCH", "DELETE" (C<s>R</s>UD)</h3>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Subscriptions</h2>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Subscriptions</h2>
				<pre><code>
type Subscription {
	count: Int!
}
				</code></pre>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Subscriptions</h2>
				<pre><code>
subscription {
	count
}
				</code></pre>
			</section>
			<section>
				<span>(optional)</span>
				<h2>GraphQL Subscription<br>==<br>WebSockets</h2>
			</section>
			<section>
				<span>(optional)</span>
				<h1>Demo?</h1>
				<p>Simplest example of GraphQL query.</p>
			</section>
			<section>
				<h1>Beyond the Basics</h1>
			</section>
			<section>
				<h1>Learning Curve</h1>
			</section>
			<section>
				<h2>Learning Curve</h2>
				<p>GraphQL takes <strong>more time</strong> to learn.</p>
			</section>
			<section>
				<h1>Caching</h1>
			</section>
			<section>
				<h2>Caching</h2>
				<p>GraphQL's caching <strong>is more complex</strong>.</p>
			</section>
			<section>
				<h2>Caching: REST (Express.js)</h2>
				<pre><code>
const express = require('express');
const app = express();
const port = 3000;

app.get('/api/resource', (req, res) => {
		const resource = {
				id: 1,
				name: "Resource",
				value: "Some data",
				lastModified: new Date().toISOString()
		};

		// Set Cache-Control header
		res.setHeader('Cache-Control', 'public, max-age=3600');
		// Set ETag header
		const eTag = 'some-etag-value';
		res.setHeader('ETag', eTag);

		// Check if the client's ETag matches the server's ETag
		if (req.headers['if-none-match'] === eTag) {
				return res.status(304).send(); // Not Modified
		}

		res.json(resource);
});

app.listen(port, () => {
		console.log(`Server is running on http://localhost:${port}`);
});
				</code></pre>
			</section>
			<section>
				<h2>Caching: GraphQL (Apollo Server)</h2>
				<pre><code>
const { ApolloServer, gql } = require('apollo-server');
const { ApolloServerPluginCacheControl } = require('apollo-server-core');

// Schema definition
const typeDefs = gql`
	type Query {
		resource(id: ID!): Resource
	}

	type Resource {
		id: ID!
		name: String
		value: String
	}
`;

// Resolvers
const resolvers = {
	Query: {
		resource: (parent, { id }, context, info) => {
			// Set cache control hints
			info.cacheControl.setCacheHint({ maxAge: 3600 });
			return { id, name: "Resource", value: "Some data" };
		}
	}
};

// Apollo Server setup
const server = new ApolloServer({
	typeDefs,
	resolvers,
	plugins: [ApolloServerPluginCacheControl({ defaultMaxAge: 5 })],
	cacheControl: {
		defaultMaxAge: 3600,
	}
});

server.listen().then(({ url }) => {
	console.log(`Server ready at ${url}`);
});

				</code></pre>
			</section>
			<section>
				<h2>Caching: GraphQL (Apollo Client)</h2>
				<pre><code>
import { ApolloClient, InMemoryCache, gql } from '@apollo/client';

// Initialize Apollo Client
const client = new ApolloClient({
	uri: 'https://example.com/graphql',
	cache: new InMemoryCache()
});

// Query
const GET_RESOURCE = gql`
	query GetResource($id: ID!) {
		resource(id: $id) {
			id
			name
			value
		}
	}
`;

// Fetch data
client.query({
	query: GET_RESOURCE,
	variables: { id: 1 }
}).then(result => {
	console.log(result.data);
	// Data is now cached in the client
});

// Subsequent queries will use the cached data
client.query({
	query: GET_RESOURCE,
	variables: { id: 1 }
}).then(result => {
	console.log('From Cache:', result.data);
});
				</code></pre>
			</section>
			<section>
				<h1>Error Handling</h1>
			</section>
			<section>
				<h2>Error Handling</h2>
				<p>Beyond 200 when an error occured.</p>
			</section>
			<section>
				<h1>Error Handling</h1>
				<table>
					<tr>
						<th>REST</th>
						<th>GraphQL</th>
					</tr>
					<tr>
						<td>Status codes to indicate nature of errors</td>
						<td>Error classes (Apollo Server)</td>
					</tr>
					<tr>
						<td>Error messages within response body</td>
						<td>Error messages within resolvers</td>
					</tr>
					<tr>
						<td>Well-known middlewares</td>
						<td>Can be nested "thanks" to GraphQL queries</td>
					</tr>
				</table>
			</section>
			<section>
				<h2>Error Handling: REST</h2>
				<pre><code>
try {
	const resource = await Resource.findByPk(id);
	if (resource) {
		res.json(resource);
	} else {
		res.status(404).json({ error: 'Resource not found' });
	}
} catch (error) {
	res.status(500).json({ error: error.message });
}
				</code></pre>
			</section>
			<section>
				<h2>Error Handling: GraphQL</h2>
				<pre><code>
try {
	const resource = await Resource.findByPk(id);
	if (resource) {
		return resource;
	} else {
		throw new UserInputError('Resource not found');
	}
} catch (error) {
	throw new Error('Failed to fetch resource');
}
				</code></pre>
			</section>
			<section>
				<h1>Demo</h1>
				<p>Let's see an error.</p>
			</section>
			<section>
				<h2>Some errors<br>!==<br>200</h2>
				<ul>
					<li>Bad Request: 400</li>
					<li>Unauthorized: 401</li>
					<li>Forbidden: 403</li>
					<li>Internal Server Error: 500</li>
				</ul>
			</section>
			<section>
				<h1>Global Object Identification</h1>
			</section>
			<section>
				<h2>Global Object Identification</h2>
				<p>Let my frontend fetch a single ID.</p>
			</section>
			<section>
				<h2>Global Object Identification: GraphQL</h2>
				<pre><code>
query {
	user(id: "1") {
		id
		name
		email
	}
}
				</pre></code>
			</section>
			<section>
				<h2>Global Object Identification: REST</h2>
				<pre><code>
GET /resources/:id
				</code></pre>
			</section>
			<section>
				<h1>Pagination</h1>
			</section>
			<section>
				<h2>Pagination</h2>
				<p>Let my frontend fetch a page.</p>
			</section>
			<section>
				<h2>Pagination: GraphQL</h2>
				<pre><code>
query {
	items(limit: 10, offset: 20) {
		total
		limit
		offset
		items {
			id
			name
		}
	}
}
				</pre></code>
			</section>
			<section>
				<h2>Pagination: REST</h2>
				<pre><code>
GET /api/items?limit=10&offset=20
				</code></pre>
			</section>
			<section>
				<h1>Sorting</h1>
			</section>
			<section>
				<h2>Sorting</h2>
				<p>Let my frontend sort the results.</p>
			</section>
			<section>
				<h2>Sorting: GraphQL</h2>
				<pre><code>
query {
	items(sort: { field: "name", order: DESC }) {
		id
		name
	}
}
			</pre></code>
			</section>
			<section>
				<h2>Sorting: REST</h2>
				<pre><code>
GET /api/items?sortBy=name&order=desc
				</code></pre>
			</section>
			<section>
				<h1>StackOverflow</h1>
			</section>
			<section>
				<h2>StackOverflow</h2>
				<p>What are Developers asking for?</p>
			</section>
			<section>
				<img data-src="assets/graphql-stackoverflow.png">
			</section>
			<section>
				<img data-src="assets/graphql-stackoverflow2.png">
			</section>
			<section>
				<img data-src="assets/graphql-stackoverflow3.png">
			</section>
			<section>
				<h1>Introspection</h1>
			</section>
			<section>
				<img data-src="assets/introspection.png">
			</section>
			<section>
				<h1>Demo</h1>
				<p>Introspection in practice.</p>
			</section>
			<section>
				<img data-src="assets/introspection-off-prod.png">
			</section>
			<section>
				<img data-src="assets/graphql-voyager.png">
			</section>
			<section>
				<img data-src="assets/introspection-security.png">
			</section>
			<section>
				<img data-src="assets/owasp-introspection.png">
			</section>
			<section>
				<h1>Circular Queries</h1>
			</section>
			<section>
				<h1>Demo</h1>
				<p>Digging with nesting.</p>
			</section>
			<section>
				<h1>Standardization<br>vs<br>Fragmentation</h1>
			</section>
			<section>
				<h2>Standardization: REST</h2>
				<p>HTTP methods (GET, POST, PUT, DELETE), status codes (200, 404, 500).</p>
			</section>
			<section>
				<h2>Fragmentation: GraphQL</h2>
				<p>Apollo Server, GraphQL Yoga, Envelop, Express-GraphQL (deprecated), Apollo Client, Relay, urql.</p>
			</section>
			<section>
				<h1>Projects</h1>
			</section>
			<section>
				<img data-src="assets/dataloader.png">
			</section>
			<section>
				<img data-src="assets/graphql-voyager-outdated.png">
			</section>
			<section>
				<img data-src="assets/graphql-voyager-fails.png">
			</section>
			<section>
				<img data-src="assets/graphql-newsletter.png">
			</section>
			<section>
				<img data-src="assets/maintainers-apollo-graphql.png">
				<img data-src="assets/maintainers-theguild.png">
			</section>
			<section>
				<h1>Unit Testing</h1>
			</section>
			<section>
				<h2>Unit Testing: REST</h2>
				<pre><code>
const express = require('express');
const app = express();
app.use(express.json());

let resources = [{ id: 1, name: 'Resource1' }];

app.get('/api/resources', (req, res) => {
	res.json(resources);
});

app.post('/api/resources', (req, res) => {
	const newResource = { id: resources.length + 1, name: req.body.name };
	resources.push(newResource);
	res.status(201).json(newResource);
});

module.exports = app;
				</pre></code>
			</section>
			<section>
				<h2>Unit Testing: GraphQL</h2>
				<pre><code>
const { ApolloServer, gql } = require('apollo-server');

const typeDefs = gql`
	type Resource {
		id: ID!
		name: String!
	}

	type Query {
		resources: [Resource]
	}

	type Mutation {
		createResource(name: String!): Resource
	}
`;

let resources = [{ id: 1, name: 'Resource1' }];

const resolvers = {
	Query: {
		resources: () => resources,
	},
	Mutation: {
		createResource: (parent, { name }) => {
			const newResource = { id: resources.length + 1, name };
			resources.push(newResource);
			return newResource;
		},
	},
};

const server = new ApolloServer({ typeDefs, resolvers });

module.exports = server;
				</pre></code>
			</section>
			<section>
				<h2>Unit Testing: REST</h2>
				<pre><code>
const request = require('supertest');
const app = require('../app');
const { expect } = require('chai');

describe('REST API', () => {
	it('should get all resources', async () => {
		const res = await request(app).get('/api/resources');
		expect(res.status).to.equal(200);
		expect(res.body).to.be.an('array');
		expect(res.body.length).to.equal(1);
	});

	it('should create a new resource', async () => {
		const res = await request(app).post('/api/resources').send({ name: 'Resource2' });
		expect(res.status).to.equal(201);
		expect(res.body).to.have.property('id');
		expect(res.body).to.have.property('name', 'Resource2');
	});
});
				</pre></code>
			</section>
			<section>
				<h2>Unit Testing: GraphQL</h2>
				<pre><code>
const { createTestClient } = require('apollo-server-testing');
const { expect } = require('chai');
const server = require('../schema');

const { query, mutate } = createTestClient(server);

describe('GraphQL API', () => {
	it('should get all resources', async () => {
		const GET_RESOURCES = `
			query {
				resources {
id
name
				}
			}
		`;
		const res = await query({ query: GET_RESOURCES });
		expect(res.data.resources).to.be.an('array');
		expect(res.data.resources.length).to.equal(1);
	});

	it('should create a new resource', async () => {
		const CREATE_RESOURCE = `
			mutation($name: String!) {
				createResource(name: $name) {
					id
					name
				}
			}
		`;
		const res = await mutate({ mutation: CREATE_RESOURCE, variables: { name: 'Resource2' } });
		expect(res.data.createResource).to.have.property('id');
		expect(res.data.createResource).to.have.property('name', 'Resource2');
	});
});
				</pre></code>
			</section>
			<section>
				<h1>Demo</h1>
				<p>Unit Testing in GraphQL.</p>
			</section>
			<section>
				<h1>Trends</h1>
			</section>
			<section>
				<img data-src="assets/interest-github.png">
			</section>
			<section>
				<img data-src="assets/interest-google-trends.png">
			</section>
			<section>
				<img data-src="assets/interest-stackoverflow.png">
			</section>
			<section>
				<img data-src="assets/interest-satisfaction.png">
			</section>
			<section>
				<h1>Conclusion</h1>
			</section>
			<section>
				<img data-src="assets/ditectrev-github.png">
				<p>100% OpenSource: AWS, Azure, GCP, and more.</p>
			</section>
			<section>
				<img data-src="assets/ditectrev-qrcode.png" height="550">
				<p>https://github.com/ditectrev</p>
			</section>
		</div>
	</div>

	<script src="dist/reveal.js"></script>
	<script src="plugin/notes/notes.js"></script>
	<script src="plugin/markdown/markdown.js"></script>
	<script src="plugin/highlight/highlight.js"></script>
	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			hash: true,

			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
		});
	</script>
</body>

</html>
